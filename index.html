<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Graduate Applications Tracker ‚Äî Enhanced</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.3/chart.umd.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-adapter-date-fns/3.0.0/chartjs-adapter-date-fns.bundle.min.js"></script>
  <!-- Firebase (compat versions for maximum browser compatibility) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
    
    :root{
      --bg:#f8fafc; --card:#ffffff; --muted:#64748b; --text:#0f172a;
      --accent1:#0ea5e9; --accent2:#8b5cf6; --shadow:0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
      --radius:12px; --border:#e2e8f0;
      --applied:#3b82f6; --online-assessment:#f59e0b; --video-interview:#10b981; --assessment-centre:#8b5cf6; --final-interview:#06b6d4; --interview:#34d399; --offer:#10b981; --rejected:#ef4444; --ghosted:#6b7280;
      --very-low:#ef4444; --low:#f59e0b; --medium:#6b7280; --high:#10b981; --very-high:#059669;
    }
    *{ box-sizing:border-box } html,body{ height:100% }
    body{ margin:0; font-family:'Inter',system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif; color:var(--text);
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); background-attachment:fixed }
    .app{ max-width:1400px; margin:28px auto; padding:0 20px 40px }
    header{ display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:20px; flex-wrap:wrap }
    .logo{ display:flex; align-items:center; gap:14px }
    .logo .dot{ width:12px; height:12px; border-radius:50%; background:linear-gradient(135deg,var(--accent1),var(--accent2)); box-shadow:0 0 0 6px rgba(139,92,246,.15),0 0 0 12px rgba(14,165,233,.08) }
    h1{ font-size:clamp(22px,3vw,30px); margin:0; font-weight:800; letter-spacing:.3px }
    .sub{ color:var(--muted); font-size:14px }

    .controls{ display:flex; flex-wrap:wrap; gap:10px; align-items:center }
    button,.btn{ background:linear-gradient(135deg,rgba(14,165,233,.1),rgba(139,92,246,.1)); border:1px solid var(--border);
      color:var(--text); padding:10px 14px; border-radius:8px; font-weight:600; cursor:pointer; transition:all .2s ease }
    button:hover{ background:linear-gradient(135deg,rgba(14,165,233,.15),rgba(139,92,246,.15)); transform:translateY(-1px) }
    .btn-danger{ background:linear-gradient(135deg,rgba(239,68,68,.1),rgba(239,68,68,.05)); border-color:rgba(239,68,68,.3) }
    .btn-ghost{ background:transparent; border-color:var(--border) }

    .badge{ display:inline-flex; align-items:center; gap:6px; padding:8px 10px; border-radius:999px; font-size:12px; border:1px solid var(--border); background:rgba(255,255,255,.8) }
    .badge.ok{ border-color:rgba(16,185,129,.5); background:rgba(16,185,129,.1) }
    .badge.warn{ border-color:rgba(245,158,11,.5); background:rgba(245,158,11,.1) }
    .badge.off{ border-color:rgba(239,68,68,.5); background:rgba(239,68,68,.1) }

    .grid{ display:grid; grid-template-columns:1.3fr .9fr; gap:18px; align-items:start }
    @media (max-width:1050px){ .grid{ grid-template-columns:1fr } }

    .card{ background:var(--card); border:1px solid var(--border);
      border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; animation:fadeUp .6s ease both }
    @keyframes fadeUp{ from{ opacity:0; transform:translateY(10px)} to{ opacity:1; transform:translateY(0)} }
    .card header{ padding:16px 18px; border-bottom:1px solid var(--border); background:rgba(248,250,252,.5) }
    .card header h2{ margin:0; font-size:18px; font-weight:700 }
    .card .content{ padding:16px 18px }

    /* Search Bar */
    .search-container{ margin-bottom:16px; position:relative }
    .search-input{ width:100%; padding:12px 16px 12px 40px; border:1px solid var(--border); border-radius:8px; 
      background:var(--card); color:var(--text); font-size:14px }
    .search-input:focus{ border-color:var(--accent1); box-shadow:0 0 0 3px rgba(14,165,233,.1); outline:none }
    .search-icon{ position:absolute; left:12px; top:50%; transform:translateY(-50%); color:var(--muted); font-size:16px }
    .search-clear{ position:absolute; right:12px; top:50%; transform:translateY(-50%); background:none; 
      border:none; color:var(--muted); cursor:pointer; font-size:18px; display:none }
    .search-results{ font-size:12px; color:var(--muted); margin-top:8px }

    form{ display:grid; grid-template-columns:1fr 1fr; gap:12px } form .full{ grid-column:1/-1 }
    label{ font-size:12px; color:var(--muted); display:block; margin-bottom:6px; font-weight:500 }
    input,select,textarea{ width:100%; padding:12px; border-radius:8px; border:1px solid var(--border); background:var(--card); color:var(--text) }
    input:focus,select:focus,textarea:focus{ border-color:var(--accent1); box-shadow:0 0 0 3px rgba(14,165,233,.1); outline:none }
    textarea{ min-height:90px; resize:vertical }

    /* Table */
    .table-toolbar{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-bottom:10px }
    .table-toolbar select{ min-width:160px }
    table{ width:100%; border-collapse:separate; border-spacing:0 8px }
    thead th{ text-align:left; font-size:12px; color:var(--muted); font-weight:700; padding:8px 10px; user-select:none; cursor:pointer; 
      background:rgba(248,250,252,.8); border-radius:6px }
    thead th.sortable:hover{ color:var(--text) }
    thead th .arrow{ opacity:.6; font-size:10px; margin-left:6px }
    tbody tr{ background:var(--card); border:1px solid var(--border);
      border-radius:8px; box-shadow:var(--shadow); transition:all .2s ease }
    tbody tr:hover{ transform:translateY(-2px); box-shadow:0 8px 25px -5px rgba(0,0,0,0.1) }
    tbody td{ padding:12px 10px; vertical-align:top; font-size:13px }
    tbody td:first-child{ border-top-left-radius:8px; border-bottom-left-radius:8px }
    tbody td:last-child{ border-top-right-radius:8px; border-bottom-right-radius:8px }

    /* Status-based row coloring */
    .row-status-Applied{ border-left: 4px solid var(--applied) }
    .row-status-Online-Assessment{ border-left: 4px solid var(--online-assessment) }
    .row-status-Video-Interview{ border-left: 4px solid var(--video-interview) }
    .row-status-Assessment-Centre{ border-left: 4px solid var(--assessment-centre) }
    .row-status-Final-Interview{ border-left: 4px solid var(--final-interview) }
    .row-status-Interview{ border-left: 4px solid var(--interview) }
    .row-status-Offer{ border-left: 4px solid var(--offer) }
    .row-status-Rejected{ border-left: 4px solid var(--rejected) }
    .row-status-Ghosted{ border-left: 4px solid var(--ghosted) }

    /* Chance rating styling */
    .chance-very-low{ color:var(--very-low); font-weight:600 }
    .chance-low{ color:var(--low); font-weight:600 }
    .chance-medium{ color:var(--medium); font-weight:600 }
    .chance-high{ color:var(--high); font-weight:600 }
    .chance-very-high{ color:var(--very-high); font-weight:600 }

    /* Days in stage indicator */
    .days-indicator{ font-size:11px; color:var(--muted); display:block; margin-top:4px }
    .days-indicator.warning{ color:#f59e0b; font-weight:600 }
    .days-indicator.danger{ color:#ef4444; font-weight:600 }

    /* Ghosting indicator */
    .ghosted-flag{ background:rgba(239,68,68,.1); color:#dc2626; padding:2px 6px; border-radius:4px; 
      font-size:10px; font-weight:600; margin-left:6px }

    /* Charts */
    .charts{ display:grid; grid-template-columns:1.2fr 1fr; gap:14px; margin-bottom:20px }
    @media (max-width:900px){ .charts{ grid-template-columns:1fr } }
    .chart-wrap{ padding:12px; background:var(--card); border:1px solid var(--border); border-radius:8px; position:relative; min-width:0; overflow:hidden }
    .chart-wrap.enlargeable{ cursor:zoom-in }
    .chart-wrap .expand-hint{ position:absolute; right:10px; top:8px; font-size:12px; color:var(--muted) }
    #statusPie{ min-height:280px; width:100% }

    /* Analytics Dashboard */
    .analytics-grid{ display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px; margin-bottom:16px }
    .stat-card{ background:var(--card); border:1px solid var(--border); border-radius:8px; padding:16px; text-align:center }
    .stat-number{ font-size:24px; font-weight:800; color:var(--accent1); margin:0 }
    .stat-label{ font-size:12px; color:var(--muted); margin:4px 0 0 0 }

    .hidden{ display:none }
    a.link{ color:var(--accent1); text-decoration:none } a.link:hover{ text-decoration:underline }

    .sector-chip{ display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:rgba(248,250,252,.8); border:1px solid var(--border) }
    .sector-chip .del{ background:transparent; border:none; color:#ef4444; cursor:pointer; font-weight:800; line-height:1 }

    /* Modal */
    .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:50 }
    .modal.show{ display:flex }
    .backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.5) }
    .modal-card{ position:relative; width:min(1100px,92vw); height:min(72vh,720px); background:var(--card); border:1px solid var(--border); border-radius:12px; box-shadow:0 25px 50px -12px rgba(0,0,0,0.25); overflow:hidden }
    .modal-card header{ display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-bottom:1px solid var(--border); background:rgba(248,250,252,.5) }
    .modal-card h3{ margin:0; font-size:16px }
    .modal-card .close{ background:transparent; border:1px solid var(--border); color:var(--text); padding:6px 10px; border-radius:8px; cursor:pointer }
    .modal-card .body{ padding:12px; height:calc(100% - 48px) }

    .top-right{ display:flex; align-items:center; gap:8px; flex-wrap:wrap }

    /* Duplicate warning */
    .duplicate-warning{ background:rgba(245,158,11,.1); border:1px solid rgba(245,158,11,.3); 
      border-radius:8px; padding:12px; margin-bottom:12px; color:#92400e }
    .duplicate-warning h4{ margin:0 0 8px 0; font-size:14px }
    .duplicate-warning ul{ margin:8px 0 0 0; padding-left:20px }

    @media (max-width: 768px) {
      .analytics-grid{ grid-template-columns:1fr 1fr }
      header{ flex-direction:column; align-items:stretch }
      .top-right{ justify-content:center }
    }
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <div class="logo">
        <span class="dot"></span>
        <div>
          <h1>Graduate Applications Tracker</h1>
          <div class="sub">Enhanced with success tracking, duplicate prevention, and smart analytics</div>
        </div>
      </div>
      <div class="controls top-right">
        <span id="syncBadge" class="badge off" title="Cloud sync status">Offline</span>
        <button id="signinBtn" type="button">Sign in with Google</button>
        <button id="signoutBtn" class="btn-ghost hidden" type="button">Sign out</button>
        <button id="exportJsonBtn" title="Download a local backup" type="button">Export JSON</button>
        <button id="importJsonBtn" class="btn-ghost" title="Restore from a JSON backup" type="button">Import JSON</button>
        <input type="file" id="importFile" accept="application/json" class="hidden" />
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <header>
          <h2>Applications</h2>
        </header>
        <div class="content">
          <!-- Analytics Dashboard -->
          <div class="analytics-grid">
            <div class="stat-card">
              <div class="stat-number" id="totalApps">0</div>
              <div class="stat-label">Total Applications</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="responseRate">0%</div>
              <div class="stat-label">Response Rate</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="avgResponseTime">0</div>
              <div class="stat-label">Avg Response (days)</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="bestEffortLevel">-</div>
              <div class="stat-label">Best Effort Level</div>
            </div>
          </div>

          <!-- Charts -->
          <div class="charts">
            <div class="chart-wrap enlargeable" id="dailyWrap" title="Click to enlarge">
              <span class="expand-hint">Click to enlarge</span>
              <canvas id="dailyChart" height="150" aria-label="Applications per day and cumulative"></canvas>
            </div>
            <div class="chart-wrap" id="statusWrap">
              <canvas id="statusPie" height="150" aria-label="Applications by status"></canvas>
            </div>
          </div>

          <!-- Search Bar -->
          <div class="search-container">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" class="search-input" placeholder="Search companies, roles, or descriptions..." />
            <button type="button" id="searchClear" class="search-clear">√ó</button>
            <div id="searchResults" class="search-results"></div>
          </div>

          <div class="table-toolbar">
            <div>
              <label for="sectorFilter" style="font-size:12px; color:var(--muted); display:block; margin-bottom:4px;">Filter by sector</label>
              <select id="sectorFilter"></select>
            </div>
            <div>
              <label for="chanceFilter" style="font-size:12px; color:var(--muted); display:block; margin-bottom:4px;">Filter by chance</label>
              <select id="chanceFilter">
                <option value="">All chances</option>
                <option value="Very High">Very High</option>
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low">Low</option>
                <option value="Very Low">Very Low</option>
              </select>
            </div>
            <div>
              <label for="sortKey" style="font-size:12px; color:var(--muted); display:block; margin-bottom:4px;">Sort by</label>
              <select id="sortKey">
                <option value="applied">Applied date</option>
                <option value="company">Company</option>
                <option value="location">Location</option>
                <option value="sector">Sector</option>
                <option value="chance">Chance rating</option>
                <option value="effort">Effort level</option>
                <option value="closing">Closing date</option>
                <option value="start">Start date</option>
              </select>
            </div>
            <div>
              <label for="sortDir" style="font-size:12px; color:var(--muted); display:block; margin-bottom:4px;">Direction</label>
              <select id="sortDir">
                <option value="desc">Descending</option>
                <option value="asc">Ascending</option>
              </select>
            </div>
            <div style="align-self:end; padding-bottom:2px">
              <button id="applySortBtn" class="btn-ghost" type="button">Apply</button>
              <button id="clearFilterBtn" class="btn-ghost" type="button">Clear</button>
            </div>
          </div>

          <div style="overflow:auto">
            <table id="appsTable">
              <thead>
                <tr>
                  <th class="sortable" data-key="company">Company <span class="arrow" id="arrow-company"></span></th>
                  <th class="sortable" data-key="role">Role <span class="arrow" id="arrow-role"></span></th>
                  <th class="sortable" data-key="sector">Sector <span class="arrow" id="arrow-sector"></span></th>
                  <th>Status</th>
                  <th class="sortable" data-key="chance">Chance <span class="arrow" id="arrow-chance"></span></th>
                  <th class="sortable" data-key="effort">Effort <span class="arrow" id="arrow-effort"></span></th>
                  <th class="sortable" data-key="applied">Applied <span class="arrow" id="arrow-applied"></span></th>
                  <th class="sortable" data-key="closing">Closing <span class="arrow" id="arrow-closing"></span></th>
                  <th class="sortable" data-key="start">Start <span class="arrow" id="arrow-start"></span></th>
                  <th class="sortable" data-key="location">Location <span class="arrow" id="arrow-location"></span></th>
                  <th>Link</th>
                  <th>Description</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="sub" style="margin-top:10px">
            <span id="lastBackup" class="badge warn">No cloud backup yet</span>
          </div>
        </div>
      </section>

      <aside class="card">
        <header>
          <h2 id="formTitle">Add Application</h2>
        </header>
        <div class="content">
          <!-- Duplicate Warning -->
          <div id="duplicateWarning" class="duplicate-warning hidden">
            <h4>‚ö†Ô∏è Potential Duplicates Found</h4>
            <p>Similar applications already exist:</p>
            <ul id="duplicateList"></ul>
            <p>Continue anyway or check existing applications.</p>
          </div>

          <form id="appForm">
            <input type="hidden" id="appId" />

            <div>
              <label for="company">Company</label>
              <input id="company" required placeholder="e.g., Acme Corp" />
            </div>
            <div>
              <label for="role">Role Title</label>
              <input id="role" required placeholder="e.g., Graduate Analyst" />
            </div>

            <div>
              <label for="sector">Sector</label>
              <select id="sector" required></select>
            </div>
            <div>
              <label for="status">Status</label>
              <select id="status" required>
                <option>Applied</option>
                <option>Online Assessment</option>
                <option>Video Interview</option>
                <option>Assessment Centre</option>
                <option>Final Interview</option>
                <option>Interview</option>
                <option>Offer</option>
                <option>Rejected</option>
                <option>Ghosted</option>
              </select>
            </div>

            <div>
              <label for="chance">Chance Rating</label>
              <select id="chance" required>
                <option>Very Low</option>
                <option>Low</option>
                <option selected>Medium</option>
                <option>High</option>
                <option>Very High</option>
              </select>
            </div>
            <div>
              <label for="effort">Effort Level</label>
              <select id="effort" required>
                <option>Quick Apply</option>
                <option selected>Standard Application</option>
                <option>Fully Customised</option>
                <option>AI Cover Letter</option>
                <option>AI Answers</option>
                <option>Non-AI Cover Letter</option>
              </select>
            </div>

            <div>
              <label for="applied">Applied Date</label>
              <input id="applied" type="date" required />
            </div>
            <div>
              <label for="closing">Closing Date</label>
              <input id="closing" type="date" />
            </div>

            <div>
              <label for="start">Start Date</label>
              <input id="start" type="date" />
            </div>
            <div>
              <label for="location">Location</label>
              <input id="location" placeholder="e.g., London" />
            </div>

            <div class="full">
              <label for="url">Job Link (optional)</label>
              <input id="url" type="url" placeholder="https://company.com/graduate-role" />
            </div>

            <div class="full">
              <label for="description">Role Description</label>
              <textarea id="description" placeholder="Short summary or notes"></textarea>
            </div>

            <div class="full" style="display:flex; gap:10px; margin-top:4px">
              <button type="submit" id="saveBtn">Save</button>
              <button type="button" id="cancelEditBtn" class="btn-ghost hidden">Cancel Edit</button>
            </div>
          </form>

          <hr style="border:none; border-top:1px solid var(--border); margin:18px 0">

          <div>
            <h3 style="margin:0 0 8px; font-size:14px">Manage Sectors</h3>
            <div class="controls" style="gap:8px">
              <input id="newSector" placeholder="Add sector (e.g., Finance)"/>
              <button id="addSectorBtn" type="button">Add</button>
            </div>
            <div id="sectorsList" style="margin-top:10px; display:flex; flex-wrap:wrap; gap:8px"></div>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <!-- Modal for enlarged Daily chart -->
  <div class="modal" id="dailyModal" aria-hidden="true">
    <div class="backdrop" id="modalBackdrop"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <header>
        <h3 id="modalTitle">Applications per Day (Cumulative)</h3>
        <button class="close" id="modalClose" type="button">Close ‚úï</button>
      </header>
      <div class="body">
        <canvas id="modalDailyCanvas"></canvas>
      </div>
    </div>
  </div>

  <script>
    // ============================
    // Local storage + UI (Enhanced)
    // ============================
    const STORAGE_KEY = 'gradAppTracker:data:v11';
    const SECTORS_KEY = 'gradAppTracker:sectors:v4';
    const DEFAULT_SECTORS = ['Finance','Consulting','Engineering','Sales'];
    const STAGES = ['Applied','Online Assessment','Video Interview','Assessment Centre','Final Interview','Interview','Offer','Rejected','Ghosted'];
    const EFFORT_LEVELS = ['Quick Apply','Standard Application','Fully Customised','AI Cover Letter','AI Answers','Non-AI Cover Letter'];
    const CHANCE_LEVELS = ['Very Low','Low','Medium','High','Very High'];

    function uuid(){ return crypto.randomUUID ? crypto.randomUUID() : (Date.now().toString(36)+Math.random().toString(36).slice(2,8)) }

    function loadData(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(raw) return JSON.parse(raw);
      const keys = ['gradAppTracker:data:v10','gradAppTracker:data:v9','gradAppTracker:data:v8'];
      for(const k of keys){ const v = localStorage.getItem(k); if(v) return JSON.parse(v); }
      return [];
    }
    function saveData(data){ localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); queueCloudSave(); }

    function loadSectors(){
      const raw = localStorage.getItem(SECTORS_KEY);
      if(raw) return JSON.parse(raw);
      const keys = ['gradAppTracker:sectors:v3','gradAppTracker:sectors:v2'];
      for(const k of keys){ const v = localStorage.getItem(k); if(v) return JSON.parse(v); }
      return [...DEFAULT_SECTORS];
    }
    function saveSectors(sectors){ localStorage.setItem(SECTORS_KEY, JSON.stringify([...new Set(sectors)].filter(Boolean))); queueCloudSave(); }

    let applications = loadData();
    let sectors = loadSectors();
    let filteredApplications = [...applications];

    // UI refs
    const appsTableBody = document.querySelector('#appsTable tbody');
    const sectorSelect = document.querySelector('#sector');
    const sectorsList = document.querySelector('#sectorsList');
    const sectorFilter = document.querySelector('#sectorFilter');
    const chanceFilter = document.querySelector('#chanceFilter');
    const form = document.querySelector('#appForm');
    const formTitle = document.querySelector('#formTitle');
    const cancelEditBtn = document.querySelector('#cancelEditBtn');
    const duplicateWarning = document.querySelector('#duplicateWarning');
    const duplicateList = document.querySelector('#duplicateList');

    const searchInput = document.querySelector('#searchInput');
    const searchClear = document.querySelector('#searchClear');
    const searchResults = document.querySelector('#searchResults');

    const exportBtn = document.querySelector('#exportJsonBtn');
    const importBtn = document.querySelector('#importJsonBtn');
    const importFile = document.querySelector('#importFile');

    const sortKeySel = document.querySelector('#sortKey');
    const sortDirSel = document.querySelector('#sortDir');
    const applySortBtn = document.querySelector('#applySortBtn');
    const clearFilterBtn = document.querySelector('#clearFilterBtn');

    const dailyWrap = document.getElementById('dailyWrap');
    const statusWrap = document.getElementById('statusWrap');
    const dailyModal = document.getElementById('dailyModal');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalClose = document.getElementById('modalClose');

    // Analytics elements
    const totalAppsEl = document.getElementById('totalApps');
    const responseRateEl = document.getElementById('responseRate');
    const avgResponseTimeEl = document.getElementById('avgResponseTime');
    const bestEffortLevelEl = document.getElementById('bestEffortLevel');

    const signinBtn = document.getElementById('signinBtn');
    const signoutBtn = document.getElementById('signoutBtn');
    const syncBadge = document.getElementById('syncBadge');
    const lastBackupEl = document.getElementById('lastBackup');

    let dailyChart, statusPie, modalDailyChart;
    let currentSort = { key: 'applied', dir: 'desc' };
    let search
